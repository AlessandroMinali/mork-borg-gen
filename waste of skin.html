<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Waste of Skin - Classes MÖRK BORG Character Generator</title>
  <meta name="description" content="Waste of Skin - Classes MÖRK BORG Character Generator">
  <style type="text/css">
    body { font-family: sans-serif; }
    .smaller { font-size: 85%; }
  </style>
</head>

<body>
  <div id=prompt>
    Which stats would you like to be stronger (select 2):
    <form id="selection">
      <input type="checkbox" id="agi" name="agility" value=0>
      <label for="agi"><b>AGILITY</b> <span class="smaller">Defend, balance, swim, flee</span></label><br>
      <input type="checkbox" id="pre" name="presence" value=1>
      <label for="pre"><b>PRESENCE</b> <span class="smaller">Perceive, aim, charm, wield Powers</span></label><br>
      <input type="checkbox" id="str" name="strength" value=2>
      <label for="str"><b>STRENGTH</b> <span class="smaller">Crush, lift, strike, grapple</span></label><br>
      <input type="checkbox" id="tou" name="toughness" value=3>
      <label for="tou"><b>TOUGHNESS</b> <span class="smaller">Resist poison/cold/heat, survive falling</span></label><br>
      <input type="submit" value="Spawn">
    </form>
  </div>
  <div id=character style="display: none;">
    <div id="name"><b>NAME:</b> </div>
    <div id="traits"><b>TRAITS:</b> </div>
    <div id="bodies"><b>BODY:</b> </div>
    <div id="habit"><b>HABIT:</b> </div>
    <div id="history"><b>HISTORY:</b> </div>
    <br>
    <div style="display: inline-block;" id="hp"><b>HP:</b> </div>
    <div style="display: inline-block;" id="omens"><b>OMENS:</b> </div>
    <div id="ablities"><b>ABILITIES</b></div>
    <div id="agility"><em>AGILITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></div>
    <div id="presence"><em>PRESENCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></div>
    <div id="strength"><em>STRENGTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em></div>
    <div id="toughness"><em>TOUGHNESS&nbsp;&nbsp;&nbsp;&nbsp;</em></div>
    <br>
    
    <div><b>EQUIPMENT</b>:
      <ul id="equipment">
      </ul>
    </div>
  </div>

  <script>
    function d(max) {
      return Math.floor(Math.random() * max) + 1;
    }
    function random_item_from(array) {
      return array[Math.floor(Math.random() * array.length)];
    }
    function removeSmallest(arr) {
        var min = Math.min(...arr);
        return arr.filter(e => e != min);
    }

    var total_checks = 0;
    checkboxes = document.querySelectorAll('input[type=checkbox]');
    for(var i = 0, len = checkboxes.length; i < len; i++) {
      checkboxes[i].addEventListener('change', function() {
        if (this.checked) {
          total_checks += 1;
        } else {
          total_checks -= 1;
        }

        if (total_checks > 2) {
          alert("Stop fooling around vagrant, only select two!");
          document.querySelectorAll('input[type=checkbox]').forEach(e => e.checked = false);
          total_checks = 0;
        }
      })
    }

    document.getElementById("prompt").addEventListener('submit', function(e) {
      e.preventDefault();

      document.getElementById("prompt").style.display = "none";
      document.getElementById("character").style.display = "block";
      generate();
    })

    function generate() {
      var names = ["Aerg-Tval","Agn","Arvant","Belsum","Belum","Brinta","B\xf6rda","Daeru","Eldar","Felban","Gotven","Graft","Grin","Grittr","Haer\xfc","Hargha","Harmug","Jotna","Karg","Karva","Katla","Keftar","Klort","Kratar","Kutz","Kvetin","Lygan","Margar","Merkari","Nagl","Niduk","Nifehl","Pr\xfcgl","Qillnach","Risten","Svind","Theras","Therg","Torvul","T\xf6rn","Urm","Urvarg","Vagal","Vatan","Von","Vrakh","Vresi","Wemut"];
      
      document.getElementById("name").innerHTML += names[(d(6) - 1)*8 + d(8) - 1];

      var traits = ["Endlessly aggravated", "Inferiority complex", "Problems with authority", "Loud mouth", "Cruel", "Egocentric", "Nihilistic", "Prone to substance abuse", "Conflicted", "Shrewd", "Vindictive", "Cowardly", "Lazy", "Suspicious", "Ruthless", "Worried", "Bitter", "Deceitful", "Wasteful", "Arrogant"];

      var t1 = random_item_from(traits);
      var t2 = t1;
      while (t2 == t1) {
        var t2 = random_item_from(traits);
      }

      document.getElementById("traits").innerHTML += t1 + " and " + t2;

      var bodies = ["Staring manic gaze", "Covered in (for some) blasphemous tattoos", "Rotting face. Wears a mask", "Lost three toes, limps", "Starved: faunt and pale", "One hand replaced with rusting hook (d6 damage)", "Decaying teeth", "Hauntingly beautiful, unnervingly clean", "Hands caked with sores", "Cataracts slowly but surly spreading in both eyes", "Long tangled hair, at least one cockroach in residence", "Broken, crushed ears", "Juddering and stuttering from nerve damage or stress", "Corpulent, ravenous, drooling", "One hand lacks thumb and index finger, grips like a lobster", "Red, swollen alcoholic’s nose", "Resting maniac face, making friends is hard", "Chronic athlete’s foot. Stinks", "Recently slashed and stinking eye covered with a patch", "Nails cracked and black, maybe about to drop off"]

      document.getElementById("bodies").innerHTML += random_item_from(bodies);

      var bad_habits = ["Obsessively collect small sharp stones", "Won’t use a blade without testing it on your own flesh. Arms knitted with scars", "Can’t stop drinking once you start", "Gambling addict. Must bet every day. If you lose, raise and bet again", "Cannot tolerate criticism of any kind. Results in rage and weeping", "Unable to get to the point. Have never actually finished a story", "Best friend is a skull. Carry it with you, tell it everything, you trust no one more", "You pick your nose so deep it bleeds", "Laugh hysterically at your own jokes which you then explain in detail", "A nihilist. You insist on telling everyone you are a nihilist and explaining why", "Inveterate bug eater", "Stress response is aesthetic display. The worse things get the fancier you need to be", "Permanent phlegm deposit in throat. Continuously cough, snort, spit and swallow", "Pyromaniac", "Consistently lose important items and forget vital facts", "Insecure shit-stirrer. Will talk about whoever just left the room", "You stutter when lying", "You giggle insanely at the worst possible times", "You whistle while trying to hide. You will deny this. Whistle when 5, 7, 9, 11 or 13 is rolled on a d20", "You make jewelry from the teeth of the dead"]
      var habit = 20;
      var special_item;
      if (habit == 1) {
        special_item =["Sackcloth bag", "and " + (d(20) + d(20) + d(20) + d(20) + d(20)) + " small sharp stones"]
      } else if (habit == 7) {
        special_item =["Skull", "a trusted friend"]
      } else if (habit == 20) {
        special_item = ["String Necklace", "with " + (d(10) + d(10) + d(10) + d(10) + d(10)) + " mismatched teeth"]
      }
      document.getElementById("habit").innerHTML += bad_habits[habit-1] + ".";

      var tales = ["Pursued for manslaughter. There is a bounty.", "In massive debt. The debt is being traded to successively more ruthless groups.", "Have a rare, sought after item.", "Have a cursed never healing wound.", "Had an illegal, immoral and secret affair with a member of the royal family. Has proof.", "Escaped cult member. Terrified and paranoid. Other cultists are everywhere.", "An identity thief who recently killed and replaced this person.", "Banished and disowned for unspecified deeds. Can never go home.", "Deserted military after witnessing a massacre, bounty on head. Hunted by former friends.", "Very recently murdered a close relative. Very recently.", "A puzzle cube has been calibrated incorrectly (or has it?), awkening a slimbering abomination.", "Evil creatures love the scent of your spoor and are drawn to it, bringing disaster in your wake.", "A battle wound left a shard of metal slowly inching closer to your heart. Every day there is a 2% chance it reaches it.", "Violence forced you into the wilderness. You think waving trees are whispering. You talk to, scream at, attack trees.", "Cursed to share the nightmares of others, you sleep far, far away.", "At permanent war with all corvids. No contact without some violence. You carry a sling.", "After dreaming of an underground temple to a forgotten god you understand the songs of insects and worms.", "Being tracked and observed by a golem after an agreement which you know has been wiped form your mind.", "\'Burn or be burned\' is the fate you accept.", "Your flesh heals twice as fast, but your companions twice as slow. You see a many-eye \'guardian angel\'."]
      var story = d(20);
      document.getElementById("history").innerHTML += tales[story - 1];

      var abilities = [" -3", " -3", " -3", " -3", " -2", " -2", " -1", " -1", "±0", "±0", "±0", "±0", "+1", "+1", "+2", "+2", "+3", "+3", "+3", "+3"]

      // var stats = [];
      var selected = Array.from(document.querySelectorAll('input[type=checkbox]:checked')).map(e => e.value);

      var stats = []
      for(var i = 0; i < 4; i++) {
        stats.push(selected.includes(i) ? removeSmallest([d(6), d(6), d(6), d(6)]).reduce((partialSum, a) => partialSum + a, 0) : d(6) + d(6) + d(6))
      }

      document.getElementById("agility").innerHTML += abilities[stats[0]];
      document.getElementById("presence").innerHTML += abilities[stats[1]];
      document.getElementById("strength").innerHTML += abilities[stats[2]];
      document.getElementById("toughness").innerHTML += abilities[stats[3]];
      var hp = Math.max(1, (parseInt(abilities[stats[3]]) || 0) + d(8));
      document.getElementById("hp").innerHTML += hp + "/" + hp;

      var food = ["Waterskin", " and " + d(4) + " days' worth of food"]
      var silver = (d(6) + d(6))*10 + " silver"

      var unclean_scrolls = [
        ["Palms Open the Southern Gate (unclean scroll)", "A ball of fire hits d2 creatures dealing d8 damage per creature"],
        ["Tongue of Eris (unclean scroll)", "A creature of your choice is confused for 10 minutes"],
        ["Te-Le-Kin-Esis (unclean scroll)", "Move an object up to d10*10 feet for d6 minutes"],
        ["Lucy-Fires Levitation (unclean scroll)", "Hover for PRESENCE + d10 rounds"],
        ["Daemon of Capillaries (unclean scroll)", "One creature suffocates for d6 rounds, losing d4 HP per round"],
        ["Metzhuotl Blind Your Eye (unclean scroll)", "A creature becomes invisible for d6 rounds or until it is damaged, attacking/defending with DR6"],
        ["Foul Psychompomp (unclean scroll)", "Summon (d6): 1-3 d4 skeletons, 4-6 d4 zombies"],
        ["Eyelid Blinds the Mind (unclean scroll)", "d4 creatures fall asleep for one hour unless they succeed a DR14 test"],
        ["Death (unclean scroll)", "All Creatures within 30 fett lose a total of 4d10 HP"]
      ]

      var sacred_scrolls = [
        ["Grace of a Dead Saint (sacred scroll)", "d2 creatures regain d10 HP each"],
        ["Grace for a Sinner (sacred scroll)", "A creature of your choice gets +d6 on one roll (damage, tests, etc.)"],
        ["Whispers Pass the Gate (sacred scroll)", "Ask three questions to a deceased creature"],
        ["Aegis of Sorrow (sacred scroll)", "A creature of your choice gains 2d6 extra HP for 10 rounds"],
        ["Unmet Fate (sacred scroll)", "One creature, dead for no more than a week, is awakened with terrible memories"],
        ["Beastial Speech (sacred scroll)", "You may speak with animals for d20 minutes"],
        ["False Dawn/Night's Chariot (sacred scroll)", "Light or pitch black for 3d10 minutes"],
        ["Hermetic Step (sacred scroll)", "You find all traps in your path of 2d10 minutes"],
        ["Roskoe's Consuming Glare (sacred scroll)", "d4 creatures lose d8 each"],
        ["Enochian Syntax (sacred scroll)", "One creature blindly obeys a single command"]
      ]

      var weapons = [
        ["Femur", "d4 damage"],
        ["Staff", "d4 damage"],
        ["Shortsword", "d4 damage"],
        ["Knife", "d4 damage"],
        ["Warhammer", "d6 damage"],
        ["Sword", "d6 damage"],
        ["Bow", "d6 damage, with " + stats[1]+10 + " arrows"],
        ["Flail", "d8 damage"],
        ["Crossbow", "d8 damage, with" + stats[1]+10 + " bolts"],
        ["Zweihänder", "d10 damage"]
      ]

      var light = ["Fur", "Padded cloth", "Leather"];
      var medium = ["Scale", "Mail"];
      var heavy = ["Splint", "Plate"];
      var armor = [
        ["", ""],
        [random_item_from(light) + " armor", "-d2 damage, tier 1"],
        [random_item_from(medium) + " armor", "-d4 damage, tier 2, DR+2 on AGILITY tests including defence"],
        [random_item_from(heavy) + " armor", "-d6 damage, tier 3, DR+4 on AGILITY tests, defence is DR+2"],
      ]

      var equip1 = [
        ["", ""],
        ["", ""],
        ["Backpack", "for 7 normal-size items"],
        ["Sack", "for 10 normal-sized items"],
        ["Small wagon", ""],
        ["Donkey", ""]
      ]

      var equip2 = [
        ["Rope", "30 feet"],
        [stats[1]+4+" torches", ""],
        ["Lantern", "with oil for " + stats[1] + 6 + " hours"],
        ["Magnesium strip", ""],
        random_item_from(unclean_scrolls),
        ["Sharp needle", ""],
        ["Medicine chest", stats[1] + 4 + " uses (stops bleeding/infection and heals d6 HP)"],
        ["Metal file and lockpicks", ""],
        ["Bear trap", "PRESENCE DR14 to spot, d8 damage"],
        ["Bomb", "(sealed bottle, d10 damage)"],
        ["A bottle of red poison", d(4) + " doses (TOUGHNESS DR12 or d10 damage)"],
        ["Silver crucifix", ""]
      ]

      var equip3 = [
        ["Life elixir", d(4) + " doses (heals d6 HP and removes infection"],
        random_item_from(sacred_scrolls),
        ["Small but vicious dog", "(" + d(6)+2 + " HP, bite d4, only obeys you)"],
        [d(4) + " monkey(s) that ignore but love you", "(" + d(4)+2 + " HP, punch/bite d4)"],
        ["Exquisite perfume", "worth 25s"],
        ["Toolbox", "10 nails, tongs, hammer, small saw, drill"],
        ["Heavy chain", "15 feet"],
        ["Grappling hook", ""],
        ["Shield", "(-1 HP damage or have the shield break to ignore on attack"],
        ["Crowbar", "(d4 damage)"],
        ["Lard", "(may function as 5 meals in a pinch)"],
        ["Tent", ""]
      ]

      var equip4 = [
        ["Blanket", ""],
        ["Firesteel", ""],
        ["Chewing tabacco", d(4) + " doses"],
        ["A bottle of salt", ""],
        ["Wooden crucifix", ""],
        ["Manacles", ""],
        ["A bottle of black poison", d(4) + " doses (TOUGHNESS DR14 or d6 damage + blind for one hour)"],
        [d(4) + " moderately tame rat(s)", "(2 HP, bite d2, only obeys you)"],
        ["Mirror", "worth 15s"],
        ["Scissors", ""],
        ["Meat cleaver", "d4 damage"],
        ["Caltrops", "d4 damage + infection on 1-in-6"],
        ["Hammer", "d4 damage"],
        ["Noose", ""],
        [d(4) + " pieces of chalk", ""]
      ]

      document.getElementById("equipment").innerHTML += "<li>" + food[0] + "<em class='smaller'>" + food[1] + "</em></li>";

      var e1 = random_item_from(equip1);
      var e2 = d(12);
      var e3 = d(12);
      var scroll = e2 == 5 || e3 == 2;
      e2 = equip2[e2 - 1];
      e3 = equip3[e3 - 1];

      var starting_weapon = scroll ? random_item_from(weapons.slice(0, 6)) : random_item_from(weapons);
      document.getElementById("equipment").innerHTML += "<li>" + starting_weapon[0] + "<em class='smaller'>&nbsp;" + starting_weapon[1] + "</em></li>";

      var starting_armor = scroll ? random_item_from(armor.slice(0, 2)) : random_item_from(armor);
      if (starting_armor[0] != "") {
        document.getElementById("equipment").innerHTML += "<li>" + starting_armor[0] + "<em class='smaller'>&nbsp;" + starting_armor[1] + "</em></li>";
      }

      document.getElementById("equipment").innerHTML += "<li>" + special_item[0] + "<em class='smaller'>&nbsp;" + special_item[1] + "</em></li>";

      if (e1[0] != "") {
        document.getElementById("equipment").innerHTML += "<li>" + e1[0] + "<em class='smaller'>&nbsp;" + e1[1] + "</em></li>";
      }
      document.getElementById("equipment").innerHTML += "<li>" + e2[0] + "<em class='smaller'>&nbsp;" + e2[1] + "</em></li>";
      document.getElementById("equipment").innerHTML += "<li>" + e3[0] + "<em class='smaller'>&nbsp;" + e3[1] + "</em></li>";

      if (story == 20 || d(100) <= 20) {
        let e4 = random_item_from(equip4);
        document.getElementById("equipment").innerHTML += "<li>" + e4[0] + "<em class='smaller'>&nbsp;" + e4[1] + "</em></li>";
      }

      document.getElementById("equipment").innerHTML += "<li>" + silver + "</li>";
      document.getElementById("omens").innerHTML += d(2) + " (d2)";
    }
  </script>
</body>
</html>